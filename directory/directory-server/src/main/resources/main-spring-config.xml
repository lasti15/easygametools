<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:s="http://www.springframework.org/schema/security"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:aop="http://www.springframework.org/schema/aop"
    xmlns:tx="http://www.springframework.org/schema/tx"
    xmlns:p="http://www.springframework.org/schema/p"
xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd
        http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd
		http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-2.0.1.xsd
		">

	<context:annotation-config/>
	
	
	<import resource="classpath:spring-config.xml"/>
	
	<bean
	       class="org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor"/>
	
	<bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
	    <property name="entityManagerFactory" ref="myEmf"/>
	  </bean>
	
	<bean id="myEmf" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean" p:dataSource-ref="dataSource" p:jpaVendorAdapter-ref="jpaAdapter">
	  <property name="loadTimeWeaver">
	    <bean class="org.springframework.instrument.classloading.InstrumentationLoadTimeWeaver"/>
	  </property>
	  <property name="persistenceUnitName" value="directory" />
	  <property name="jpaProperties">
	  	<props>
         <prop key="hibernate.dialect">${hibernate.dialect}</prop>
         <prop key="hibernate.hbm2ddl.auto">false</prop>
		 <prop key="hibernate.connection.username">${hibernate.connection.username:webuser}</prop>
		 <prop key="hibernate.connection.password">${hibernate.connection.password:password}</prop>
		 <prop key="hibernate.c3p0.min_size">${hibernate.c3p0.min_size}</prop>
		 <prop key="hibernate.c3p0.max_size">${hibernate.c3p0.max_size}</prop>
		 <prop key="hibernate.c3p0.timeout">${hibernate.c3p0.timeout}</prop>
		 <prop key="hibernate.c3p0.max_statements">${hibernate.c3p0.max_statements}</prop>
		 <prop key="hibernate.show_sql">${hibernate.show_sql}</prop>
	  	</props>
	  </property>
	 </bean>
	 
	 <bean id="dataSource"
	       class="org.springframework.jdbc.datasource.DriverManagerDataSource"
	       p:driverClassName="${hibernate.connection.driver_class}" p:url="${hibernate.connection.url}"/>
	 
	 <bean id="jpaAdapter"
	         class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter" />
 
</beans>
    